# Afilmory - ç°ä»£åŒ–ç…§ç‰‡é›†é™æ€ç«™ç‚¹ç”Ÿæˆå™¨

<p align="center">
  <img src="https://github.com/vsxd/assets/blob/main/afilmory-readme.webp?raw=true" alt="Afilmory" width="100%" />
</p>

Afilmory (/É™ËˆfÉªlmÉ™ri/, "uh-FIL-muh-ree") æ˜¯ä¸€ä¸ªä¸“ä¸ºæ‘„å½±çˆ±å¥½è€…è®¾è®¡çš„é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ï¼Œç±»ä¼¼äº Hexo/Hugoï¼Œä½†ä¸“æ³¨äºç…§ç‰‡å±•ç¤ºã€‚å®ƒç»“åˆäº†è‡ªåŠ¨ç…§ç‰‡å¤„ç†ã€ç°ä»£åŒ–å‰ç«¯æŠ€æœ¯å’Œç®€å•çš„éƒ¨ç½²æµç¨‹ï¼Œè®©ä½ è½»æ¾åˆ›å»ºå±äºè‡ªå·±çš„ç…§ç‰‡é›†ç½‘ç«™ã€‚

**âœ¨ åœ¨çº¿æ¼”ç¤º:**
- https://afilmory.innei.in
- https://gallery.mxte.cc
- https://photography.pseudoyu.com
- https://afilmory.magren.cc

## ğŸŒŸ ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½

- ğŸ–¼ï¸ **é«˜æ€§èƒ½ WebGL å›¾ç‰‡æ¸²æŸ“å™¨** - è‡ªå®šä¹‰ WebGL ç»„ä»¶ï¼Œæµç•…çš„ç¼©æ”¾å’Œå¹³ç§»
- ğŸ“± **å“åº”å¼ç€‘å¸ƒæµå¸ƒå±€** - åŸºäº Masonicï¼Œé€‚é…ä¸åŒå±å¹•å°ºå¯¸
- ğŸ¨ **ç°ä»£ UI è®¾è®¡** - Glassmorphic è®¾è®¡ç³»ç»Ÿï¼ŒTailwind CSS 4
- âš¡ **å¢é‡æ„å»º** - æ™ºèƒ½å˜æ›´æ£€æµ‹ï¼Œåªå¤„ç†æ–°å¢æˆ–ä¿®æ”¹çš„ç…§ç‰‡
- ğŸŒ **å›½é™…åŒ–** - å†…ç½®å¤šè¯­è¨€æ”¯æŒ
- ğŸ”— **OpenGraph** - ç¤¾äº¤åª’ä½“åˆ†äº«é¢„è§ˆ

### å›¾ç‰‡å¤„ç†

- ğŸ”„ **HEIC/HEIF æ”¯æŒ** - è‡ªåŠ¨è½¬æ¢ Apple è®¾å¤‡ç…§ç‰‡æ ¼å¼
- ğŸ“· **TIFF æ”¯æŒ** - è‡ªåŠ¨è½¬æ¢ä¸“ä¸šæ‘„å½±æ ¼å¼
- ğŸ–¼ï¸ **æ™ºèƒ½ç¼©ç•¥å›¾ç”Ÿæˆ** - å¤šå°ºå¯¸ç¼©ç•¥å›¾ï¼Œä¼˜åŒ–åŠ è½½é€Ÿåº¦
- ğŸ“Š **EXIF ä¿¡æ¯å±•ç¤º** - å®Œæ•´çš„æ‹æ‘„å‚æ•°ï¼šç›¸æœºã€ç„¦è·ã€å…‰åœˆç­‰
- ğŸŒˆ **Blurhash å ä½å›¾** - ä¼˜é›…çš„å›¾ç‰‡åŠ è½½ä½“éªŒ
- ğŸ“± **Live Photo æ”¯æŒ** - æ£€æµ‹å’Œå±•ç¤º iPhone åŠ¨æ€ç…§ç‰‡
- â˜€ï¸ **HDR å›¾ç‰‡æ”¯æŒ** - å±•ç¤º HDR å›¾ç‰‡

### é«˜çº§åŠŸèƒ½

- ğŸ›ï¸ **å¯Œå£«èƒ¶ç‰‡æ¨¡æ‹Ÿ** - è¯»å–å¹¶å±•ç¤ºå¯Œå£«ç›¸æœºèƒ¶ç‰‡æ¨¡æ‹Ÿè®¾ç½®
- ğŸ” **å…¨å±æŸ¥çœ‹å™¨** - æ”¯æŒæ‰‹åŠ¿çš„å›¾ç‰‡æŸ¥çœ‹å™¨
- ğŸ·ï¸ **æ–‡ä»¶ç³»ç»Ÿæ ‡ç­¾** - åŸºäºæ–‡ä»¶ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆæ ‡ç­¾
- âš¡ **å¹¶å‘å¤„ç†** - å¤šè¿›ç¨‹/å¤šçº¿ç¨‹å¹¶å‘å¤„ç†æ”¯æŒ
- ğŸ—‚ï¸ **å¤šå­˜å‚¨æ”¯æŒ** - S3ã€GitHub å’Œæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ
- ğŸ“· **å›¾ç‰‡åˆ†äº«** - åˆ†äº«åˆ°ç¤¾äº¤åª’ä½“æˆ–åµŒå…¥ç½‘ç«™
- ğŸ—ºï¸ **äº¤äº’å¼åœ°å›¾** - ä½¿ç”¨ MapLibre å±•ç¤ºå¸¦ GPS åæ ‡çš„ç…§ç‰‡

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js 18+
- pnpm 10+

### å®‰è£…

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/vsxd/afilmory-vercel.git
cd afilmory-vercel

# å®‰è£…ä¾èµ–
pnpm install
```

### é…ç½®

1. **å‡†å¤‡ S3 å­˜å‚¨å¹¶ä¸Šä¼ ç…§ç‰‡**

å°†ä½ çš„ç…§ç‰‡ä¸Šä¼ åˆ° S3 å…¼å®¹çš„å¯¹è±¡å­˜å‚¨ä¸­ï¼Œæ”¯æŒä»¥ä¸‹æ ¼å¼ï¼š
- JPG / JPEG
- PNG
- HEIC (Apple è®¾å¤‡)
- TIFF

**é‡è¦æç¤ºï¼šæœ¬é¡¹ç›®ä»…æ”¯æŒ S3 å…¼å®¹å­˜å‚¨ï¼Œç…§ç‰‡ä¸ä¼šè¢«æ‰“åŒ…åˆ°éƒ¨ç½²äº§ç‰©ä¸­ã€‚**

2. **é…ç½®ç¯å¢ƒå˜é‡**

åˆ›å»º `.env` æ–‡ä»¶ï¼Œå¡«å†™ä½ çš„ S3 é…ç½®ï¼š

```bash
S3_BUCKET_NAME=your-bucket-name
S3_REGION=us-east-1
S3_ACCESS_KEY_ID=your-access-key-id
S3_SECRET_ACCESS_KEY=your-secret-access-key
S3_ENDPOINT=https://s3.us-east-1.amazonaws.com
S3_PREFIX=photos/
S3_CUSTOM_DOMAIN=https://your-cdn-domain.com  # å¯é€‰
```

3. **é…ç½®ç«™ç‚¹ä¿¡æ¯** (å¯é€‰)

```bash
cp config.example.json config.json
```

ç¼–è¾‘ `config.json`:

```json
{
  "name": "æˆ‘çš„ç…§ç‰‡é›†",
  "title": "My Afilmory",
  "description": "è®°å½•ç”Ÿæ´»ä¸­çš„ç¾å¥½ç¬é—´",
  "url": "https://your-site.vercel.app",
  "author": {
    "name": "Your Name",
    "url": "https://your-website.com"
  }
}
```

### æ„å»ºå’Œé¢„è§ˆ

```bash
# å®Œæ•´æ„å»ºï¼ˆå¤„ç†ç…§ç‰‡ + æ„å»ºå‰ç«¯ï¼‰
pnpm build

# æœ¬åœ°é¢„è§ˆ
pnpm preview
```

æ‰“å¼€ http://localhost:4173 é¢„è§ˆä½ çš„ç…§ç‰‡ç«™ç‚¹ï¼

## ğŸ“¦ éƒ¨ç½²

### éƒ¨ç½²åˆ° Vercelï¼ˆæ¨èï¼‰

#### æ–¹å¼ä¸€ï¼šGitHub è‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¨èï¼‰

1. å°†é¡¹ç›®æ¨é€åˆ° GitHub
2. åœ¨ [vercel.com](https://vercel.com) å¯¼å…¥é¡¹ç›®
3. åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­é…ç½®ç¯å¢ƒå˜é‡ï¼š
   - `S3_BUCKET_NAME`
   - `S3_REGION`
   - `S3_ACCESS_KEY_ID`
   - `S3_SECRET_ACCESS_KEY`
   - `S3_ENDPOINT`ï¼ˆå¯é€‰ï¼‰
   - `S3_PREFIX`ï¼ˆå¯é€‰ï¼‰
   - `S3_CUSTOM_DOMAIN`ï¼ˆå¯é€‰ï¼‰
4. ç‚¹å‡» "Deploy"
5. æ¯æ¬¡æ¨é€åˆ° `main` åˆ†æ”¯è‡ªåŠ¨é‡æ–°éƒ¨ç½²

#### æ–¹å¼äºŒï¼šCLI éƒ¨ç½²

```bash
# å®‰è£… Vercel CLI
npm i -g vercel

# ç¡®ä¿æœ¬åœ° .env æ–‡ä»¶å·²é…ç½®
# éƒ¨ç½²
vercel --prod
```

### é™æ€éƒ¨ç½²

é¡¹ç›®æ”¯æŒé™æ€ç«™ç‚¹éƒ¨ç½²ï¼Œæ„å»ºäº§ç‰©ä½äº `apps/web/dist` ç›®å½•ã€‚ä½ å¯ä»¥å°†æ„å»ºåçš„é™æ€æ–‡ä»¶éƒ¨ç½²åˆ°ä»»ä½•é™æ€æ‰˜ç®¡å¹³å°ã€‚

**æ„å»ºå‘½ä»¤ï¼š**
```bash
pnpm build
```

**è¾“å‡ºç›®å½•ï¼š** `apps/web/dist`

è¯¦è§ [éƒ¨ç½²æŒ‡å—](./DEPLOY_STATIC.md)

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ

- **React 19** - æœ€æ–°ç‰ˆæœ¬ï¼ŒåŒ…å« React Compiler
- **TypeScript** - å®Œæ•´çš„ç±»å‹å®‰å…¨
- **Vite 7** - ç°ä»£æ„å»ºå·¥å…·
- **Tailwind CSS 4** - åŸå­åŒ– CSS
- **Radix UI** - æ— éšœç¢ç»„ä»¶åº“
- **Jotai** - çŠ¶æ€ç®¡ç†
- **TanStack Query** - æ•°æ®è·å–å’Œç¼“å­˜
- **React Router 7** - è·¯ç”±ç®¡ç†
- **i18next** - å›½é™…åŒ–

### æ„å»ºç³»ç»Ÿ

- **Node.js** - æœåŠ¡ç«¯è¿è¡Œæ—¶
- **Sharp** - é«˜æ€§èƒ½å›¾ç‰‡å¤„ç†
- **AWS SDK** - S3 å­˜å‚¨æ“ä½œï¼ˆå¯é€‰ï¼‰
- **Worker Threads/Cluster** - å¹¶å‘å¤„ç†
- **EXIF-Reader** - EXIF æ•°æ®æå–

### å­˜å‚¨æ¶æ„

**æœ¬é¡¹ç›®ä»…æ”¯æŒ S3 å…¼å®¹å­˜å‚¨**ï¼Œä¸ä¼šå°†ç…§ç‰‡æ‰“åŒ…åˆ°éƒ¨ç½²äº§ç‰©ä¸­ï¼Œç¡®ä¿é¡¹ç›®ä½“ç§¯å°ï¼Œé€‚åˆé™æ€éƒ¨ç½²å’Œ Vercel ç­‰å¹³å°ã€‚

æ”¯æŒçš„ S3 å…¼å®¹æœåŠ¡ï¼š
- **AWS S3** - Amazon S3 å¯¹è±¡å­˜å‚¨
- **MinIO** - å¼€æºå¯¹è±¡å­˜å‚¨æœåŠ¡
- **é˜¿é‡Œäº‘ OSS** - é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨
- **è…¾è®¯äº‘ COS** - è…¾è®¯äº‘å¯¹è±¡å­˜å‚¨
- å…¶ä»– S3 å…¼å®¹æœåŠ¡

## ğŸ“ é¡¹ç›®ç»“æ„

```
afilmory-vercel/
â”œâ”€â”€ apps/
â”‚   â””â”€â”€ web/                   # ğŸ¨ å‰ç«¯ SPA åº”ç”¨
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ builder/               # ğŸ”¨ ç…§ç‰‡å¤„ç†å·¥å…·
â”‚   â”œâ”€â”€ webgl-viewer/          # ğŸ–¼ï¸ WebGL æŸ¥çœ‹å™¨
â”‚   â”œâ”€â”€ data/                  # ğŸ“Š æ•°æ®å±‚
â”‚   â”œâ”€â”€ ui/                    # ğŸ¨ UI ç»„ä»¶
â”‚   â”œâ”€â”€ hooks/                 # âš“ React Hooks
â”‚   â””â”€â”€ utils/                 # ğŸ”§ å·¥å…·å‡½æ•°
â”œâ”€â”€ config.json                # ç«™ç‚¹é…ç½®
â””â”€â”€ vercel.json                # éƒ¨ç½²é…ç½®
```

## âš™ï¸ é…ç½®é€‰é¡¹

### ç«™ç‚¹é…ç½® (`config.json`)

```json
{
  "name": "ç«™ç‚¹åç§°",
  "title": "ç«™ç‚¹æ ‡é¢˜",
  "description": "ç«™ç‚¹æè¿°",
  "url": "https://your-site.com",
  "accentColor": "#007bff",
  "author": {
    "name": "ä½œè€…å",
    "url": "https://author-site.com",
    "avatar": "https://avatar-url.jpg"
  },
  "social": {
    "github": "username",
    "twitter": "handle",
    "rss": true
  },
  "map": ["maplibre"],
  "mapStyle": "https://map-style-url.json"
}
```

### ç¯å¢ƒå˜é‡é…ç½® (`.env`)

é¡¹ç›®**ä»…æ”¯æŒ S3 å­˜å‚¨**ï¼Œå¿…é¡»é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```bash
# å¿…å¡«
S3_BUCKET_NAME=your-bucket-name
S3_REGION=us-east-1
S3_ACCESS_KEY_ID=your-access-key-id
S3_SECRET_ACCESS_KEY=your-secret-access-key

# å¯é€‰
S3_ENDPOINT=https://s3.us-east-1.amazonaws.com  # é»˜è®¤ AWS S3
S3_PREFIX=photos/                               # ç…§ç‰‡è·¯å¾„å‰ç¼€
S3_CUSTOM_DOMAIN=https://cdn.example.com        # è‡ªå®šä¹‰ CDN åŸŸå
S3_EXCLUDE_REGEX=.*\.txt$                       # æ’é™¤æŸäº›æ–‡ä»¶
```

### æ„å»ºé…ç½® (`builder.config.ts`)

é…ç½®æ–‡ä»¶å·²é¢„è®¾ä¸º S3 æ¨¡å¼ï¼Œé€šå¸¸æ— éœ€ä¿®æ”¹ï¼š

```typescript
export default defineBuilderConfig(() => ({
  storage: {
    provider: 's3',
    bucket: env.S3_BUCKET_NAME,
    region: env.S3_REGION,
    accessKeyId: env.S3_ACCESS_KEY_ID,
    secretAccessKey: env.S3_SECRET_ACCESS_KEY,
    // ... å…¶ä»– S3 é…ç½®
  },
  system: {
    processing: {
      defaultConcurrency: 10,         // å¹¶å‘æ•°
      enableLivePhotoDetection: true, // Live Photo
    },
  },
}))
```

## ğŸ“‹ CLI å‘½ä»¤

### å¼€å‘å‘½ä»¤

```bash
# å¼€å‘æ¨¡å¼ï¼ˆä¸å¤„ç†ç…§ç‰‡ï¼‰
pnpm dev

# å®Œæ•´æ„å»º
pnpm build

# åªå¤„ç†ç…§ç‰‡
pnpm build:manifest

# åªæ„å»ºå‰ç«¯
pnpm build:web

# é¢„è§ˆæ„å»ºç»“æœ
pnpm preview
```

### Manifest æ„å»ºé€‰é¡¹

```bash
# å¼ºåˆ¶é‡æ–°å¤„ç†æ‰€æœ‰ç…§ç‰‡
pnpm build:manifest -- --force

# åªé‡æ–°ç”Ÿæˆç¼©ç•¥å›¾
pnpm build:manifest -- --force-thumbnails

# åªé‡æ–°ç”Ÿæˆ manifest
pnpm build:manifest -- --force-manifest
```

## ğŸ”„ æ›´æ–°ç…§ç‰‡

### æ·»åŠ æ–°ç…§ç‰‡

1. å°†æ–°ç…§ç‰‡ä¸Šä¼ åˆ° S3 å­˜å‚¨æ¡¶
2. æ¨é€ä»£ç åˆ° GitHubï¼ˆå¦‚æœä½¿ç”¨ Vercel è‡ªåŠ¨éƒ¨ç½²ï¼‰æˆ–è¿è¡Œ `vercel --prod`
3. Vercel ä¼šè‡ªåŠ¨é‡æ–°æ„å»ºå’Œéƒ¨ç½²

å¢é‡æ„å»ºä¼šè‡ªåŠ¨æ£€æµ‹ S3 ä¸­æ–°å¢/ä¿®æ”¹çš„ç…§ç‰‡ï¼Œåªå¤„ç†å˜æ›´éƒ¨åˆ†ã€‚

### æ”¯æŒçš„æ ¼å¼

- JPG / JPEG
- PNG
- HEIC (Apple è®¾å¤‡)
- TIFF
- Live Photos (iPhone)

## ğŸ¨ è‡ªå®šä¹‰

### ä¿®æ”¹ä¸»é¢˜è‰²

ç¼–è¾‘ `config.json` çš„ `accentColor`:

```json
{
  "accentColor": "#ff6b6b"
}
```

### æ·»åŠ åœ°å›¾æ ·å¼

```json
{
  "map": ["maplibre"],
  "mapStyle": "https://your-map-style.json",
  "mapProjection": "globe"
}
```

### å›½é™…åŒ–

è¯­è¨€æ–‡ä»¶ä½äº `apps/web/public/locales/`ã€‚

æ·»åŠ æ–°è¯­è¨€ï¼š
1. åˆ›å»ºè¯­è¨€ç›®å½•ï¼ˆå¦‚ `fr/`ï¼‰
2. å¤åˆ¶å¹¶ç¿»è¯‘ `common.json`
3. åœ¨ `apps/web/src/lib/i18n.ts` æ·»åŠ è¯­è¨€ä»£ç 

## ğŸ“Š æ€§èƒ½

- âš¡ **Lighthouse è¯„åˆ†**: 95+
- ğŸ¯ **é¦–å±åŠ è½½**: < 1s
- ğŸ“¦ **Bundle å¤§å°**: ~250KB (gzipped)
- ğŸ–¼ï¸ **å›¾ç‰‡ä¼˜åŒ–**: WebP + å¤šå°ºå¯¸ç¼©ç•¥å›¾
- ğŸ’¾ **ç¼“å­˜ç­–ç•¥**: é™æ€èµ„æºæ°¸ä¹…ç¼“å­˜

## ğŸ”§ é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰å›¾ç‰‡å¤„ç†

åœ¨ `packages/builder` ä¸­æ·»åŠ è‡ªå®šä¹‰å¤„ç†å™¨ã€‚

è¯¦è§ [AGENTS.md](./AGENTS.md)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºå»ºè®®ï¼

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

Attribution Network License (ANL) v1.0 Â© 2025 Afilmory Team.

è¯¦è§ [LICENSE](LICENSE)

## ğŸ”— ç›¸å…³é“¾æ¥

- [åœ¨çº¿æ¼”ç¤º](https://afilmory.innei.in)
- [éƒ¨ç½²æŒ‡å—](./DEPLOY_STATIC.md)
- [æ¶æ„æ–‡æ¡£](./AGENTS.md)
- [GitHub Issues](https://github.com/vsxd/afilmory-vercel/issues)
- [ä½œè€…åšå®¢](https://innei.in)

## ğŸ’ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…å’Œä½¿ç”¨ Afilmory çš„æ‘„å½±çˆ±å¥½è€…ä»¬ï¼

---

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª â­ï¸ Star æ”¯æŒä¸€ä¸‹ï¼
